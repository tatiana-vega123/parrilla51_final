<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>{{ 'Editar Producto' if producto else 'Agregar Producto' }}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/global.css') }}">
</head>
<body>

  {% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="container mt-3">
      {% for category, message in messages %}
        <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

  <!-- NAVBAR -->
  <nav class="navbar">
    <div class="brand">
      <img src="{{ url_for('static', filename='image.png') }}" alt="Logo Parrilla 51">
      Parrilla 51
    </div>
   
    <a href="{{ url_for('auth.logout') }}" class="btn">Salir</a>
  </nav>

  <!-- FORMULARIO -->
  <div class="container">
    <h1>{{ 'Editar Producto' if producto else 'Agregar Producto' }}</h1>
    <form method="POST" action="{% if producto %}{{ url_for('admin.editar_producto', id_producto=producto.id_producto) }}{% else %}{{ url_for('admin.agregar_producto') }}{% endif %}">
      <label for="nombre">Nombre</label>
      <input id="nombre" type="text" name="nombre" value="{{ producto.nombre if producto else '' }}" required>

      <label for="cantidad">Cantidad</label>
      <input id="cantidad" type="number" name="cantidad" value="{{ producto.cantidad if producto else '' }}" min="0" required>

      <label for="descripcion">Descripción</label>
      <input id="descripcion" type="text" name="descripcion" value="{{ producto.descripcion if producto else '' }}">

      <label for="precio">Precio</label>
      <input id="precio" type="number" step="0.01" name="precio" value="{{ producto.precio if producto else '' }}" min="0" required>

      <label for="cod_categoria">Categoría</label>
      <select id="cod_categoria" name="cod_categoria" required>
        {% for cat in categorias %}
          <option value="{{ cat.id_categoria }}" {% if producto and producto.cod_categoria == cat.id_categoria %}selected{% endif %}>{{ cat.nombre_categoria }}</option>
        {% endfor %}
      </select>

      <label for="imagen">URL de la Imagen</label>
      <input id="imagen" type="url" name="imagen" 
            value="{{ producto.imagen if producto and producto.imagen else '' }}" 
            placeholder="https://ejemplo.com/imagen.jpg">

      <button type="submit">Guardar</button>
    </form>

    <div class="text-center">
      <a href="{{ url_for('admin.admin_productos') }}" class="volver">⬅ Volver a la lista</a>
    </div>
  </div>

  <footer>
    © 2025 Parrilla 51 - Todos los derechos reservados
  </footer>

</body>
</html>